name: Periodic Checks
on:
  schedule:
    - cron: "0 0 * * MON"
    - cron: "0 0 * * THU"
  workflow_dispatch:
jobs:
  linkcheck:
    name: Validate Markdown Links
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@c85c95e3d7251135ab7dc9ce3241c5835cc595a9
        with:
          submodules: recursive
      - uses: actions/setup-node@e33196f7422957bea03ed53f6fbb155025ffc7b8
        with:
          node-version-file: "build/.nvmrc"
          cache: "npm"
          cache-dependency-path: "build/package-lock.json"
      - name: Perform link checking
        run: |
          make linkcheck
        working-directory: build
      - name: Create an issue if bad links are detected
        if: failure()
        uses: peter-evans/create-issue-from-file@433e51abf769039ee20ba1293a088ca19d573b7f # v3.0.0
        with:
          title: Scheduled Check of Markdown Documents Found Bad Hyperlinks
          content-filepath: build/generated/mlc_report.log
          labels: |
            bug
            Scope: Documentation
