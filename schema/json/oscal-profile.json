{
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$id": "http://csrc.nist.gov/ns/oscal/1.0-profile.json",
  "definitions": {
    "import": {
      "$id": "#/definitions/import",
      "type": "object",
      "description": "",
      "properties": {
        "href": {
          "type": "string",
          "description": ""
        },
        "include": {
          "$ref": "#/definitions/include"
        },
        "exclude": {
          "$ref": "#/definitions/exclude"
        }
      },
      "propertyNames": {
        "enum": [
          "href",
          "include",
          "exclude"
        ]
      },
      "required": [
        "href"
      ]
    },
    "include": {
      "$id": "#/definitions/include",
      "type": "object",
      "description": "",
      "anyOf": [
        {
          "properties": {
            "all": {
              "type": "object",
              "description": "",
              "properties": {
                "withSubcontrols": {
                  "type": "boolean",
                  "description": ""
                }
              }
            }
          },
          "propertyNames": {
            "enum": [
              "all"
            ]
          },
          "required": [
            "all"
          ]
        },
        {
          "properties": {
            "all": {
              "type": "boolean",
              "description": "Include all controls from the invoked authority (catalog)"
            }
          },
          "propertyNames": {
            "enum": [
              "all"
            ]
          },
          "required": [
            "all"
          ]
        },
        {
          "properties": {
            "calls": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/call"
              },
              "minItems": 1
            }
          },
          "propertyNames": {
            "enum": [
              "calls"
            ]
          },
          "required": [
            "calls"
          ]
        },
        {
          "properties": {
            "matches": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/match"
              },
              "minItems": 1
            }
          },
          "propertyNames": {
            "enum": [
              "matches"
            ]
          },
          "required": [
            "matches"
          ]
        }
      ]
    },
    "merge": {
      "$id": "#/definitions/merge",
      "type": "object",
      "description": "",
      "properties": {
        "build": {
          "type": "null"
        }
      },
      "propertyNames": {
        "enum": [
          "build"
        ]
      }
    },
    "modify": {
      "$id": "#/definitions/modify",
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "paramSettings": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/paramSetting"
              }
            }
          },
          "propertyNames": {
            "enum": [
              "paramSettings"
            ]
          },
          "required": [
            "paramSettings"
          ]
        },
        {
          "type": "object",
          "properties": {
            "alterations": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/alteration"
              }
            }
          },
          "propertyNames": {
            "enum": [
              "alterations"
            ]
          },
          "required": [
            "alterations"
          ]
        }
      ]
    },
    "match": {
      "$id": "#/definitions/match",
      "type": "object",
      "properties": {
        "withSubcontrols": {
          "type": "boolean",
          "description": ""
        },
        "withControls": {
          "type": "boolean",
          "description": ""
        },
        "pattern": {
          "type": "string",
          "description": ""
        }
      },
      "propertyNames": {
        "enum": [
          "withSubcontrols",
          "withControls",
          "pattern"
        ]
      }
    },
    "exclude": {
      "$id": "#/definitions/exclude",
      "type": "object",
      "description": "Which controls and subcontrols to exclude from the authority (source catalog) being invoked",
      "properties": {
        "match": {
          "$ref": "#/definitions/match"
        },
        "calls": {
          "type": "array",
          "items": {
            "type": "object",
            "description": "",
            "properties": {
              "controlId": {
                "type": "string",
                "description": ""
              },
              "subcontrolId": {
                "type": "string",
                "description": ""
              }
            },
            "propertyNames": {
              "enum": [
                "controlId",
                "subcontrolId"
              ]
            }
          },
          "minItems": 1
        }
      },
      "propertyNames": {
        "enum": [
          "match",
          "calls"
        ]
      }
    },
    "call": {
      "$id": "#/definitions/call",
      "type": "object",
      "description": "",
      "anyOf": [
        {
          "properties": {
            "withSubcontrols": {
              "type": "boolean",
              "description": ""
            },
            "controlId": {
              "type": "string",
              "description": ""
            }
          },
          "propertyNames": {
            "enum": [
              "withSubcontrols",
              "controlId"
            ]
          }
        },
        {
          "properties": {
            "subcontrolID": {
              "type": "string",
              "description": ""
            }
          },
          "propertyNames": {
            "enum": [
              "subcontrolId"
            ]
          },
          "required": [
            "subcontrolId"
          ]
        }
      ]
    },
    "paramSetting": {
      "$id": "#/definitions/paramSetting",
      "type": "object",
      "description": "",
      "properties": {
        "paramId": {
          "type": "string",
          "description": "",
          "pattern": "^\\S*[a-zA-Z0-9.\\-_\\:]\\S*$"
        },
        "optionalClass": {
          "type": "string",
          "description": ""
        },
        "desc": {
          "type": "string",
          "description": ""
        },
        "paramValue": {
          "type": "string",
          "description": ""
        }
      },
      "propertyNames": {
        "enum": [
          "paramId",
          "class",
          "desc",
          "value"
        ]
      }
    },
    "alteration": {
      "$id": "#/definitions/alteration",
      "type": "object",
      "description": "",
      "anyOf": [
        {
          "properties": {
            "controlId": {
              "type": "string",
              "description": ""
            },
            "remove": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/remove"
              }
            },
            "augment": {
              "oneOf": [
                {
                  "$ref": "#/definitions/augment"
                },
                {
                  "type": "boolean"
                }
              ]
            }
          },
          "propertyNames": {
            "enum": [
              "controlId",
              "remove",
              "augment"
            ]
          }
        },
        {
          "properties": {
            "subcontrolId": {
              "type": "string",
              "description": ""
            },
            "remove": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/remove"
              }
            },
            "augment": {
              "oneOf": [
                {
                  "$ref": "#/definitions/augment"
                },
                {
                  "type": "boolean"
                }
              ]
            }
          },
          "propertyNames": {
            "enum": [
              "subcontrolId",
              "remove",
              "augment"
            ]
          }
        }
      ]
    },
    "remove": {
      "$id": "#/definitions/remove",
      "type": "object",
      "description": "",
      "properties": {
        "targets": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^\\S*[a-zA-Z0-9.\\-_\\:]\\S*$"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "targets"
        ]
      }
    },
    "augment": {
      "$id": "#/definitions/augment",
      "type": "object",
      "description": "",
      "properties": {
        "props": {
          "type": "array",
          "description": "",
          "items": {
            "$ref": "oscal-core.json#/definitions/prop"
          }
        },
        "parts": {
          "type": "array",
          "description": "",
          "items": {
            "$ref": "oscal-core.json#/definitions/part"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "props",
          "parts"
        ]
      }
    }
  },
  "type": "object",
  "description": "",
  "properties": {
    "profile": {
      "type": "object",
      "description": "",
      "properties": {
        "id": {
          "type": "string",
          "description": ""
        },
        "title": {
          "type": "string",
          "description": ""
        },
        "imports": {
          "description": "",
          "type": "array",
          "items": {
            "$ref": "#/definitions/import"
          },
          "minItems": 1
        },
        "merge": {
          "$ref": "#/definitions/merge"
        },
        "modify": {
          "$ref": "#/definitions/modify"
        }
      },
      "propertyNames": {
        "enum": [
          "id",
          "title",
          "imports",
          "merge",
          "modify"
        ]
      },
      "required": [
        "imports"
      ]    
    }
  },
  "propertyNames": {
    "enum": [
      "profile"
    ]
  },
  "required": [
    "profile"
  ]
}
