<?xml version="1.0" encoding="UTF-8"?>
<x:description
    xmlns="http://csrc.nist.gov/ns/oscal/1.0" xmlns:x="http://www.jenitennison.com/xslt/xspec"
    stylesheet="../../oscal-profile-resolve-merge.xsl">
    <x:scenario label="Scenario for testing a function">
        <x:context>
            <profile/>
        </x:context>

        <x:expect label="root becomes root">
            <profile/>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="Single import, no merge (flat)">
        <x:context>
            <profile>
                <catalog id="xyz-tiny_catalog">
                        <group>
                            <title>Group X of XYZ</title>
                            <control id="x1"><title>Control X1</title></control>
                            <control id="x2"><title>Control X2</title></control>
                            <control id="x3"><title>Control X3</title></control>
                        </group>
                        <group>
                            <title>Group Y of XYZ</title>
                            <control id="y1"><title>Control Y1</title></control>
                            <control id="y2"><title>Control Y2</title></control>
                            <control id="y3"><title>Control Y3</title></control>
                        </group>
                        <group>
                            <title>Group Z of XYZ</title>
                            <control id="z1"><title>Control Z1</title></control>
                            <control id="z2"><title>Control Z2</title></control>
                            <control id="z3"><title>Control Z3</title>
                                <control id="z3.a"><title>Control Z3-A</title>
                                    <control id="z3.a-1"><title>Control Z3-A-1</title></control>
                                </control>
                            </control>
                        </group>
                    </catalog>
                <!-- no merge -->
            </profile>
        </x:context>
        <x:expect label="All XYZ controls, ungrouped">
            <profile>
                <catalog id="xyz-tiny_catalog">
                    <control id="x1"><title>Control X1</title></control>
                    <control id="x2"><title>Control X2</title></control>
                    <control id="x3"><title>Control X3</title></control>
                    <control id="y1"><title>Control Y1</title></control>
                    <control id="y2"><title>Control Y2</title></control>
                    <control id="y3"><title>Control Y3</title></control>
                    <control id="z1"><title>Control Z1</title></control>
                    <control id="z2"><title>Control Z2</title></control>
                    <control id="z3"><title>Control Z3</title>
                        <control id="z3.a"><title>Control Z3-A</title>
                            <control id="z3.a-1"><title>Control Z3-A-1</title></control>
                        </control>
                    </control>
                </catalog>
            </profile>
        </x:expect>
    </x:scenario>
    <x:scenario label="Single import, as-is merge">
        <x:context>
            <profile>
                <catalog id="xyz-tiny_catalog">
                    <group>
                        <title>Group X of XYZ</title>
                        <control id="x1"><title>Control X1</title></control>
                        <control id="x2"><title>Control X2</title></control>
                        <control id="x3"><title>Control X3</title></control>
                    </group>
                    <group>
                        <title>Group Y of XYZ</title>
                        <control id="y1"><title>Control Y1</title></control>
                        <control id="y2"><title>Control Y2</title></control>
                        <control id="y3"><title>Control Y3</title></control>
                    </group>
                    <group>
                        <title>Group Z of XYZ</title>
                        <control id="z1"><title>Control Z1</title></control>
                        <control id="z2"><title>Control Z2</title></control>
                        <control id="z3"><title>Control Z3</title>
                            <control id="z3.a"><title>Control Z3-A</title>
                                <control id="z3.a-1"><title>Control Z3-A-1</title></control>
                            </control>
                        </control>
                    </group>
                </catalog>
                <merge>
                    <as-is>true</as-is>
                </merge>
            </profile>
        </x:context>
        <x:expect label="XYZ catalog with original grouping">
            <profile>
                <catalog id="xyz-tiny_catalog">
                    <group>
                        <title>Group X of XYZ</title>
                        <control id="x1"><title>Control X1</title></control>
                        <control id="x2"><title>Control X2</title></control>
                        <control id="x3"><title>Control X3</title></control>
                    </group>
                    <group>
                        <title>Group Y of XYZ</title>
                        <control id="y1"><title>Control Y1</title></control>
                        <control id="y2"><title>Control Y2</title></control>
                        <control id="y3"><title>Control Y3</title></control>
                    </group>
                    <group>
                        <title>Group Z of XYZ</title>
                        <control id="z1"><title>Control Z1</title></control>
                        <control id="z2"><title>Control Z2</title></control>
                        <control id="z3"><title>Control Z3</title>
                            <control id="z3.a"><title>Control Z3-A</title>
                                <control id="z3.a-1"><title>Control Z3-A-1</title></control>
                            </control>
                        </control>
                    </group>
                </catalog>
            </profile>
        </x:expect>
    </x:scenario>
</x:description>
