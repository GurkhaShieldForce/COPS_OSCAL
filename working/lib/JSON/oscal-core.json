{
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$id": "http://csrc.nist.gov/ns/oscal/core-1.0.json",
  "definitions": {
    "collection": {
      "$id": "#/definitions/collection",
      "type": "object",
      "description": "",
      "properties": {
        "title": {
          "type": "string",
          "description": "A fallback for display and navigation, exclusive of more specific properties"
        },
        "declarations": {
          "anyOf": [
            { "$ref": "#/definitions/declaration" },
            {
              "href": {
                "type": "string",
                "description": ""
              }
            }
          ],
          "description": "For extra-schema validation of control components within controls"
        },
        "sections": {
          "type": "array",
          "description": "For partitioning a catalog, collection, or section therein",
          "items": { "$ref": "#/definitions/section" }
        },
        "groups": {
          "type": "array",
          "description": "Related controls or groups (of controls or groups)",
          "items": { "$ref": "#/definitions/group" }
        },
        "controls": {
          "type": "array",
          "description": "",
          "items": { "$ref": "#/definitions/control" }
        }
      },
      "propertyNames": {
        "enum": [
          "title",
          "declarations",
          "sections",
          "groups",
          "controls"
        ]
      }
    },
    "declaration": {
      "$id": "#/definitions/declaration",
      "type": "object",
      "properties": {
        "declareProperties": {
          "type": "array",
          "description": "Constraints applicable to a class or classes of prop elements (properties) in context",
          "items": { "$ref": "#/definitions/declareProperty" }
        },
        "declareParts": {
          "type": "array",
          "description": "Indicates constraints to be imposed on parts in context",
          "items": { "$ref": "#/definitions/declarePart" }
        },
        "declareParagraphs": {
          "type": "array",
          "description": "Indicates constraints to be enforced on paragraphs in context",
          "items": { "$ref": "#/definitions/declareParagraph" }
        },
        "declareLinks": {
          "type": "array",
          "description": "Indicates constraints to be imposed on links in context",
          "items": { "$ref": "#/definitions/declareLink" }
        }
      },
      "propertyNames": {
        "enum": [
          "declareProperties",
          "declareParts",
          "declareParagraphs",
          "declareLinks"
        ]
      }
    },
    "declareProperty": {
      "$id": "#/definitions/declareProperty",
      "type": "object",
      "properties": {
        "context": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "class": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "identifier": {
          "type": "boolean",
          "description": "The declared component has a value unique within the document, among properties prop</code> with the same class"
        },
        "regex": {
          "type": "string",
          "description": "Indicates that the value of a property prop or parameter param must match the given regular expression"
        },
        "required": {
          "type": "boolean",
          "description": "The declared component is required in its context"
        },
        "singleton": {
          "type": "boolean",
          "description": "The declared component may occur only once in its context"
        },
        "values": {
          "type": "array",
          "description": "Indicates a permissible value for a parameter or property",
          "items": { "$ref": "#/definitions/value" }
        }
      },
      "propertyNames": {
        "enum": [
          "context",
          "class",
          "identifier",
          "regex",
          "required",
          "singleton",
          "values"
        ]
      }
    },
    "declarePart": {
      "$id": "#/definitions/declarePart",
      "type": "object",
      "properties": {
        "context": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "class": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "required": {
          "type": "boolean",
          "description": "The declared component is required in its context"
        },
        "singleton": {
          "type": "boolean",
          "description": "The declared component may occur only once in its context"
        },
        "values": {
          "type": "array",
          "description": "Indicates a permissible value for a parameter or property",
          "items": { "$ref": "#/definitions/value" }
        }
      },
      "propertyNames": {
        "enum": [
          "context",
          "class",
          "required",
          "singleton",
          "values"
        ]
      }
    },
    "declareParagraph": {
      "$id": "#/definitions/declareParagraph",
      "type": "object",
      "description": "",
      "properties": {
        "context": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "class": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        }
      },
      "propertyNames": {
        "enum": [
          "context",
          "class"
        ]
      }
    },
    "declareLink": {
      "$id": "#/definitions/declareLink",
      "type": "object",
      "description": "",
      "properties": {
        "context": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "class": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "required": {
          "type": "boolean",
          "description": "The declared component is required in its context"
        },
        "singleton": {
          "type": "boolean",
          "description": "The declared component may occur only once in its context"
        }
      },
      "propertyNames": {
        "enum": [
          "context",
          "class",
          "required",
          "singleton"
        ]
      }
    },    
    "value": {
      "$id": "#/definitions/value",
      "description": "",
      "oneOf": [
        {
          "type": "string",
          "description": ""
        },
        {
          "type": "object",
          "description": "",
          "properties": {
            "inherit": {
              "type": "boolean",
              "description": "Indicates that a value or text within a value should be inherited from a property on a containing control object"
            },
            "autonum": {
              "type": "string",
              "description": "Generates a formatted numeric value based on the position of a control object among its siblings, the text contents providing a template for the numbering format (arabic, alphabetic, roman, etc.)"
            }
          },
          "propertyNames": {
            "enum": [
              "inherit",
              "autonum"
            ]
          }
        }
      ]
    },
    "section": {
      "$id": "#/definitions/section",
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "A fallback for display and navigation, exclusive of more specific properties"
        },
        "paragraphs": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        }
      },
      "propertyNames": {
        "enum": [
          "title",
          "paragraphs"
        ]
      }
    },
    "group": {
      "$id": "#/definitions/group",
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "A fallback for display and navigation, exclusive of more specific properties"
        },
        "paragraphs": {
          "type": "array",
          "description": "",
          "items": { "type": "string" }
        },
        "controls": {
          "type": "array",
          "description": "A structured information object representing a security control",
          "items": { "$ref": "#/definitions/control" }
        }
      },
      "propertyNames": {
        "enum": [
          "title",
          "paragraphs",
          "controls"
        ]
      }
    },
    "control": {
      "$id": "#/definitions/control",
      "type": "object",
      "description": "",
      "properties": {
        "class": {
          "type": "string",
          "description": ""
        },
        "id": {
          "type": "string",
          "description": ""
        },
        "parameters": {
          "type": "array",
          "description": "A parameter setting, to be propagated to points of insertion",
          "items": { "$ref": "#/definitions/parameter" }
        },
        "properties": {
          "type": "array",
          "description": "A value with a name, attributed to the containing control, subcontrol, part, or group",
          "items": { "$ref": "#/definitions/property" }
        },
        "parts": {
          "type": "array",
          "description": "A component or partition in a control, subcontrol, or part",
          "items": { "$ref": "#/definitions/part" }
        },
        "subcontrol": {
          "type": "array",
          "description": "An associated control within a control",
          "items": { "$ref": "#/definitions/control" }
        },
        "references": {
          "type": "array",
          "description": "A reference, with one or more citations to standards, related documents, or other resources",
          "items": { "$ref": "#/definitions/reference" }
        }
      },
      "propertyNames": {
        "enum": [
          "class",
          "id",
          "parameters",
          "properties",
          "parts",
          "subcontrol",
          "references"
        ]
      }
    },
    "part": {
      "$id": "#/definitions/part",
      "type": "object",
      "description": "",
      "properties": {
        "class": {
          "type": "string",
          "description": ""
        },
        "id": {
          "type": "string",
          "description": ""
        },
        "properties": {
          "type": "array",
          "description": "A value with a name, attributed to the containing control, subcontrol, part, or group",
          "items": { "$ref": "#/definitions/property" }
        },
        "paragraphs": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "class": {
                "type": "string",
                "description": ""
              },
              "value": {
                "type": "string",
                "description": ""
              },
              "withdrawn": {
                "type": "string",
                "description": "Indicates that a containing control or subcontrol is no longer applicable"
              },
              "insert": {
                "type": "object",
                "description": "A call (reference) to a parameter for dynamic content transclusion",
                "properties": {
                  "paramID": {
                    "type": "string",
                    "description": ""
                  }
                }
              }
            },
            "propertyNames": {
              "enum": [
                "class",
                "value",
                "withdrawn",
                "insert"
              ]
            }
          }
        },
        "parts": {
          "type": "array",
          "description": "",
          "items": { "$ref": "#/definitions/part" }
        },
        "links": {
          "type": "array",
          "description": "A line or paragraph with a hypertext link",
          "items": {
            "type": "object",
            "properties": {
              "href": {
                "type": "string",
                "description": ""
              }
            },
            "propertyNames": {
              "enum": [ "href" ]
            }
          }
        }
      },
      "propertyNames": {
        "enum": [
          "class",
          "id",
          "properties",
          "paragraphs",
          "parts",
          "links"
        ]
      }
    },
    "parameter": {
      "$id": "#/definitions/parameter",
      "type": "object",
      "description": "",
      "properties": {
        "id": {
          "type": "string",
          "description": ""
        },
        "description": {
          "type": "string",
          "description": "Indicates and explains the purpose and use of a parameter"
        },
        "value": {
          "type": "string",
          "description": "Indicates a permissible value for a parameter or property"
        }
      },
      "propertyNames": {
        "enum": [
          "id",
          "description",
          "value"
        ]
      }
    },
    "property": {
      "$id": "#/definitions/property",
      "type": "object",
      "description": "",
      "properties": {
        "class": {
          "type": "string",
          "description": ""
        },
        "value": {
          "type": "string",
          "description": ""
        }
      },
      "propertyNames": {
        "enum": [
          "class",
          "value"
        ]
      }
    },
    "reference": {
      "$id": "#/definitions/reference",
      "type": "object",
      "description": "",
      "patternProperties": {
        "^(citation|standard)$": {
          "$ref": "#/definitions/ref",
          "description": "Standard: Citation of a formal published standard\n Citation: Citation of a resource"
        }
      },
      "propertyNames": {
        "enum": [
          "citation",
          "standard"
        ]
      }
    },
    "ref": {
      "$id": "#/definitions/ref",
      "type": "object",
      "description": "",
      "properties": {
        "href": {
          "type": "string",
          "description": ""
        },
        "value": {
          "type": "string",
          "description": ""
        }
      },
      "propertyNames": {
        "enum": [
          "href",
          "value"
        ]
      }
    }    
  },
  "patternProperties": {
    "^(catalog|collection|framework)$": {
      "$ref": "#/definitions/collection",
      "description": ""
    }
  },
  "propertyNames": {
    "enum": [
      "catalog",
      "collection"
    ]
  }
}
